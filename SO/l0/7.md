# zad7

ltrace przechwytuje i wyświetla wywołania do bibliotek współdzielonych

## wywołania systemowe
- sposób w jaki user-space aplikacja prosi kernel o zrobienie czegoś uprzywilejowanego (read/write pliku itp.)

## jakie syscalle używa:
- opendir:
 - SYS_openat(0xffffff9c, 0x7ffd9d1cc9b0, 0x90800, 0)              = 3
 - SYS_fstat(3, 0x7ffd9d1cab30)                                    = 0
- readdir:
 - SYS_getdents64(3, 0x56305c67f040, 0x8000, 0)                    = 464
- printf (tutaj woła puts):
 - puts("2_cat_file.c" <unfinished ...>
    SYS_fstat(1, 0x7ffd9d1caa50)                                    = 0
    SYS_write(1, "2_cat_file.c\n", 132_cat_file.c
   )                              = 13
- closedir:
 - SYS_close(3)                                                    = 0

## co robi brk:
- ustawia program break, czyli koniec segmentu danych procesu - służy do zmniejszania lub powiększania sterty, wykorzystuje go malloc/free do zarządzania pamięcią

## gdb, catch syscall brk, która funkcja używa brk:
```
gdb ./1_ls
start .
catch syscall brk
continue
bt
```

(gdb) bt
#0  __brk (addr=addr@entry=0x0) at ../sysdeps/unix/sysv/linux/brk_call.h:24
#1  0x00007ffff7d180fb in __GI___sbrk (increment=increment@entry=167936) at sbrk.c:59
#2  0x00007ffff7ca46c6 in __glibc_morecore (increment=increment@entry=167936)
    at /usr/src/debug/glibc/glibc/malloc/morecore.c:29
#3  0x00007ffff7ca5621 in sysmalloc (nb=nb@entry=32832, av=0x7ffff7e09ac0 <main_arena>)
    at malloc.c:2720
#4  0x00007ffff7ca6933 in _int_malloc (av=av@entry=0x7ffff7e09ac0 <main_arena>, 
    bytes=bytes@entry=32816) at malloc.c:4617
#5  0x00007ffff7ca6b1f in __libc_malloc2 (bytes=32816) at malloc.c:3450
#6  0x00007ffff7ce46f6 in __alloc_dir (fd=fd@entry=3, close_fd=close_fd@entry=true, 
    flags=flags@entry=0, statp=statp@entry=0x7fffffffe410) at ../sysdeps/unix/sysv/linux/opendir.c:115
#7  0x00007ffff7ce4780 in opendir_tail (fd=3) at ../sysdeps/unix/sysv/linux/opendir.c:63
#8  0x00007ffff7ce4821 in __opendir (name=<optimized out>) at ../sysdeps/unix/sysv/linux/opendir.c:86
#9  0x0000555555555231 in main (argc=<optimized out>, argv=0x7fffffffe608) at 1_ls.c:11

czyli opendir

